<!DOCTYPE html>
<html><title>check for sgx availability</title>


<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="bLmaFyyXugiCqSup-eIIIx0B4CngtdF_svyMMKQbS5E" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=10, minimum-scale=0.5, user-scalable=yes">
<meta name="apple-mobile-web-app-capable" content="yes" />
<script src="https://hypothes.is/embed.js" async></script>


<link rel="stylesheet" href="/braindump/css/main.min.56b43bcbc759a196f9dd525bee62bdec45a29ba95902bbab74a4f7ad2ea3e8cb.css"/>

<link rel="stylesheet" href="/braindump/css/links.min.4bf1990b213fb76d2a66153dc6ef9a57d49f536c6baf6e7f19a7948470a38141.css"/>

<link rel="stylesheet" href="/braindump/css/konubinix.min.cf2d0f36945178c647979ee68f1830892e06aa3d481d8913728b5c7462b97f6e.css"/>

<link rel="stylesheet" href="/ipfs/QmQFVQS89fv1XUNFcjwCKDePzckuT9kpuAVNYUwNdEfYcv/css/all.css"/>
<link rel="shortcut icon" href="/ipfs/QmVFwYV7YRZLKU3ybN1hW4jqfyZGPLKJwd8toN2wHz5UAD?a.png" type="image/x-icon" />

<body><header>
  <div>
	<a href="/braindump//"><h5 class="site-title">Konubinix&#39; opinionated web of thoughts</h5></a>
  </div>
  <span>
	<a href="/blog/"><i class="icon fas fa-blog"></i></a>
	<a href="/braindump/posts/"><i class="icon fas fa-brain"></i></a>
    <a href="mailto:konubinixweb@gmail.com"><i class="icon fas fa-envelope-square"></i></a>
    <a href="https://github.com/konubinix"><i class="icon fab fa-github-square"></i></a>
    <a href="https://linkedin.com/in/samuel-loury-61259040"><i class="icon fab fa-linkedin"></i></a>
	<a href="/braindump/graph.html"><i class="icon fas fa-project-diagram"></i></a>
	<a href="/braindump/index.xml"><i class="icon fas fa-rss-square"></i></a>
	<a href="/braindump/tags/"><i class="icon fa fa-tag"></i></a>
	<a href="/braindump/braindump_search"><i class="icon fa fa-search"></i></a>
  </span>
</header>

<div class="grid-container">
  <div class="grid">
    <div class="page" data-level="1">
      <div class="content">
		<p class="lead">
        <h1>Check for Sgx Availability</h1>
		<span class="badge badge-pill badge-warning"><a href="/braindump/tags/fleeting/">Fleeting</a></span></p>
        <ul>
<li>External reference: <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></li>
<li>External reference: <a href="https://www.intel.com/content/www/us/en/support/articles/000057420/software/intel-security-products.html">https://www.intel.com/content/www/us/en/support/articles/000057420/software/intel-security-products.html</a></li>
</ul>
<p>Which Platforms Support Intel® Software Guard Extensions (Intel® SGX)&hellip;</p>
<ul>
<li>see,
<ul>
<li><a href="/braindump/posts/find_out_whether_your_hardware_can_play_with_sgx/">find out whether your hardware can play with sgx</a>,</li>
</ul>
</li>
</ul>
<blockquote>
<p>How to fix it:If a processor supports Intel® SGX and FLC, it supports DCAP</p>
<p>&mdash; <a href="https://www.intel.com/content/www/us/en/support/articles/000057420/software/intel-security-products.html">https://www.intel.com/content/www/us/en/support/articles/000057420/software/intel-security-products.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>two options to determine if your system&rsquo;s processor supports FLC:</p>
<p>&mdash; <a href="https://www.intel.com/content/www/us/en/support/articles/000057420/software/intel-security-products.html">https://www.intel.com/content/www/us/en/support/articles/000057420/software/intel-security-products.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Open a terminal and run: $ cpuid | grep -i sgxLook for output: SGX_LC: SGX launch config supported = true</p>
<p>&mdash; <a href="https://www.intel.com/content/www/us/en/support/articles/000057420/software/intel-security-products.html">https://www.intel.com/content/www/us/en/support/articles/000057420/software/intel-security-products.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>FLC support in Intel® Xeon® E systems is also dependent on the BIOS and firmware. The platform must have an Intel® Server Platform Services (Intel® SPS)–based BIOS and firmware. Check with your platform manufacturer to verify if it is SPS-based or not.</p>
<p>&mdash; <a href="https://www.intel.com/content/www/us/en/support/articles/000057420/software/intel-security-products.html">https://www.intel.com/content/www/us/en/support/articles/000057420/software/intel-security-products.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>CPUID is not sufficient to detect the usability of Intel® Software Guard Extensions (Intel® SGX) on a platform. Read Properly Detecting Intel® Software Guard Extensions (Intel® SGX) in Your Applications for more details on how to determine if your processor supports Intel SGX and Intel SGX is enabled</p>
<p>&mdash; <a href="https://www.intel.com/content/www/us/en/support/articles/000057420/software/intel-security-products.html">https://www.intel.com/content/www/us/en/support/articles/000057420/software/intel-security-products.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Only the top three SKUs of the Intel® Xeon® E-21xx family support FLC (E-2174G, E-2176G, E-2186G) on Intel® SPS–based platforms</p>
<p>&mdash; <a href="https://www.intel.com/content/www/us/en/support/articles/000057420/software/intel-security-products.html">https://www.intel.com/content/www/us/en/support/articles/000057420/software/intel-security-products.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>DCAP only works with:</p>
<p>8th Generation Intel® Core™ Processor or newer with Flexible Launch Control and Intel® Advanced Encryption Standard New Instructions (Intel® AES-NI) supportIntel Atom® Processor with Flexible Launch Control and Intel® AES-NI support</p>
<p>&mdash; <a href="https://www.intel.com/content/www/us/en/support/articles/000057420/software/intel-security-products.html">https://www.intel.com/content/www/us/en/support/articles/000057420/software/intel-security-products.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>what is the proper way to detect Intel SGX support on a system so that my applications and their installers behave accordingly?</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>individual CPU may support Intel SGX, whether or not Intel SGX is actually available for use depends on two components:</p>
<p>BIOS
Intel SGX Platform Software package</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>requires a BIOS from the OEM that explicitly supports Intel SGX</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Check with your device manufacturer to determine whether or not Intel SGX is supported on your system.</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>When Intel SGX is set to Enabled in the BIOS, Intel SGX has been enabled, and Intel SGX instructions and resources are available to applications</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Intel SGX reserves up to 128 MB of system RAM as Processor Reserved Memory (PRM), which is used to hold the Enclave Page Cache (EPC).</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>enabling Intel SGX consumes a portion of the system’s resources, effectively making them unavailable to other applications.</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Software Controlled setting in the BIOS allows OEMs to ship systems with support for Intel SGX in a ready state, where it can be activated via software (this is the software opt-in). This is a compromise between having Intel SGX fully enabled by default and potentially consuming system resources even when no Intel SGX software is present on the system and having it turned off completely.</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Software enabling is a one-way operation: Intel SGX cannot be disabled via software</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>The only ways to disable Intel SGX once it has been enabled are to do so via the BIOS</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Intel SGX Platform Software package, or PSW, must be installed on the system. The PSW includes:</p>
<p>Runtime libraries
Services that support and maintain the trusted compute block on the end user’s system
Services that perform and manage critical Intel SGX operations such as attestation
Interfaces to platform services such as the trusted time and monotonic counters</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>These two libraries are installed into the system library directory on Linux platforms (typically /usr/lib or /usr/lib64):</p>
<p>libsgx_uae_service.so
libsgx_urts.so</p>
<p>Applications need to load the shared objects in this order.</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Use dynamic loading, not dynamic linking</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Dynamic linking is not an option, since systems that lack Intel SGX support will not have the PSW package installed. Attempting to run a dynamically linked executable on a system without the PSW package will result in unresolved symbol errors that prevent the application from launching</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Note that the check for the PSW package that is described above begins with a dynamic load of the necessary shared libraries. The application can simply keep these handles open</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Linux developers will need to explicitly use dynamic loading in their applications</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>OS is outside of the Trusted Compute Base and malicious software can attempt to influence the preferred load order of dynamic libraries. This can lead to a denial of service of Intel SGX. Application developers can take basic precautions to mitigate against dynamic library preload attacks, but there are no foolproof solutions.</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>The CPUID instruction is not sufficient to detect the usability of Intel SGX on a platform</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>It can report whether or not the processor supports the Intel SGX instructions, but Intel SGX usability depends on both the BIOS settings and the PSW</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<figure><img src="https://software.intel.com/content/dam/develop/external/us/en/images/fig1-629256.png">
</figure>

<p>Figure 1: Intel® Software Guard Extensions feature-detection flowchart for installers</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>All Intel SGX applications must install the PSW</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>The Intel® Software Guard Extensions Feature-Detection Procedure for Linux Systems</p>
<p>The procedures for Linux systems are similar to those for Windows systems, but are complicated by disparities between the two platforms</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>The AESM service on Windows, which is part of the PSW, has always provided support for the software enable operation from user-level processes. As of this writing, the Linux distribution of the PSW does not provide this capability</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>functions for detecting Intel SGX capability as well as performing the software enable when running with administrator privileges. This library is intended to be used by application installers. The 1.9 and earlier versions of the Intel SDK for Linux do not include an equivalent library. However it is available in a branch of the source code repository as both a static and dynamic library (libsgx_capable.a and libsgx_capable.so, respectively). It is expected to be merged into the main distribution in a future release</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>must call into libsgx_capable to perform the feature detection and software enable functions</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Note that sgx_cap_enable_device() requires root privileges in order to perform the software enable, so applications installers need to be run as root</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>user-mode processes can detect the state of Intel SGX thanks to the efivarfs filesystem</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<figure><img src="https://software.intel.com/content/dam/develop/external/us/en/images/fig3-flowchart-for-linux-apps-lg-629256.png">
</figure>

<p>Figure 3: Intel® Software Guard Extensions feature-detection flowchart for Linux* applications</p>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>not possible to differentiate between the following three cases:</p>
<ul>
<li>Intel SGX is not supported by the CPU</li>
<li>Intel SGX is not supported by the BIOS</li>
<li>Intel SGX is supported by the BIOS and CPU, but explicitly disabled in the BIOS</li>
</ul>
<p>&mdash; <a href="https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html">https://software.intel.com/content/www/us/en/develop/articles/properly-detecting-intel-software-guard-extensions-in-your-applications.html</a></p>
</blockquote>
<h2 id="permalink"><a href="https://konubinix.eu/braindump/80caf6c6-2702-4c72-a438-064c484d08ed?title=check_for_sgx_availability">Permalink</a></h2>
      </div>
	  <aside class="date"><time>Last updated: 10 Aug 2021</time></aside>
	  <aside class="date"><time>Published&nbsp;&nbsp;&nbsp;: 15 Apr 2021</time></aside>
    </div>
  </div>
</div>

<script src="/braindump/js/URI.js" type="text/javascript"></script>

<script src="/braindump/js/page.js" type="text/javascript"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>
