<!DOCTYPE html>
<html><title>midi to music sheet using lilypond</title>


<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="bLmaFyyXugiCqSup-eIIIx0B4CngtdF_svyMMKQbS5E" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=10, minimum-scale=0.5, user-scalable=yes">
<meta name="apple-mobile-web-app-capable" content="yes" />
<script src="https://hypothes.is/embed.js" async></script>


<link rel="stylesheet" href="/braindump/css/main.min.56b43bcbc759a196f9dd525bee62bdec45a29ba95902bbab74a4f7ad2ea3e8cb.css"/>

<link rel="stylesheet" href="/braindump/css/links.min.4bf1990b213fb76d2a66153dc6ef9a57d49f536c6baf6e7f19a7948470a38141.css"/>

<link rel="stylesheet" href="/braindump/css/konubinix.min.cf2d0f36945178c647979ee68f1830892e06aa3d481d8913728b5c7462b97f6e.css"/>

<link rel="stylesheet" href="/ipfs/QmQFVQS89fv1XUNFcjwCKDePzckuT9kpuAVNYUwNdEfYcv/css/all.css"/>
<link rel="shortcut icon" href="/ipfs/QmVFwYV7YRZLKU3ybN1hW4jqfyZGPLKJwd8toN2wHz5UAD?a.png" type="image/x-icon" />

<body><header>
  <div>
	<a href="/braindump//"><h5 class="site-title">Konubinix&#39; opinionated web of thoughts</h5></a>
  </div>
  <span>
	<a href="/blog/"><i class="icon fas fa-blog"></i></a>
	<a href="/braindump/posts/"><i class="icon fas fa-brain"></i></a>
    <a href="mailto:konubinixweb@gmail.com"><i class="icon fas fa-envelope-square"></i></a>
    <a href="https://github.com/konubinix"><i class="icon fab fa-github-square"></i></a>
    <a href="https://linkedin.com/in/samuel-loury-61259040"><i class="icon fab fa-linkedin"></i></a>
	<a href="/braindump/graph.html"><i class="icon fas fa-project-diagram"></i></a>
	<a href="/braindump/index.xml"><i class="icon fas fa-rss-square"></i></a>
	<a href="/braindump/tags/"><i class="icon fa fa-tag"></i></a>
	<a href="/braindump/braindump_search"><i class="icon fa fa-search"></i></a>
  </span>
</header>

<div class="grid-container">
  <div class="grid">
    <div class="page" data-level="1">
      <div class="content">
		<p class="lead">
        <h1>Midi to Music Sheet Using Lilypond</h1>
		<span class="badge badge-pill badge-warning"><a href="/braindump/tags/fleeting/">Fleeting</a></span></p>
        <div class="ox-hugo-toc toc">
<div class="heading">Table of Contents</div>
<ul>
<li><a href="#create-music-sheet-for-my-kids-dot">create music sheet for my kids.</a></li>
<li><a href="#play-some-of-my-favorite-musics">play some of my favorite musics</a></li>
<li><a href="#conclusion">conclusion</a></li>
<li><a href="#permalink">Permalink</a></li>
</ul>
</div>
<!--endtoc-->
<p>midi to music sheet using <a href="/braindump/posts/lilypond/">lilypond</a></p>
<h2 id="create-music-sheet-for-my-kids-dot">create music sheet for my kids.</h2>
<p>For example, using &ldquo;le petit cochon pendu au plafond&rdquo;.</p>
<p><a href="https://konubinix.eu/ipfs/bafkreiaduaxqdu3j5epxpxjrs5nothlvagb7lretzczloifcexzsn6k4ta?filename=cochon.mid">cochon.mid</a></p>
<p>Using <a href="/braindump/posts/lilypond/#midi2ly">midi2ly</a>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>midi2ly cochon.mid
</span></span></code></pre></div><p>Then, using the <a href="http://lilypond.org/doc/v2.12/input/lsr/lilypond-snippets/Pitches#Coloring-notes-depending-on-their-pitch">snippet to color notes</a>, changing the staff to make it more
piano like and removing the silences.</p>
<p>I get this source code.</p>
<pre tabindex="0"><code class="language-lilypond" data-lang="lilypond">% Lily was here -- automatically converted by /usr/bin/midi2ly from b.mid
\version &#34;2.14.0&#34;

%LSR Thanks a LOT to Damian leGassick, Steven Weber and Jay Anderson for this snippet

%Association list of pitches to colors.
#(define color-mapping
   (list
    (cons (ly:make-pitch 0 0 NATURAL) (x11-color &#39;red))
    (cons (ly:make-pitch 0 0 SHARP) (x11-color &#39;green))
    (cons (ly:make-pitch 0 1 FLAT) (x11-color &#39;yellow))
    (cons (ly:make-pitch 0 1 NATURAL) (x11-color &#39;blue))
    (cons (ly:make-pitch 0 2 NATURAL) (x11-color &#39;red))
    (cons (ly:make-pitch 0 2 SHARP) (x11-color &#39;green))
    (cons (ly:make-pitch 0 3 FLAT) (x11-color &#39;red))
    (cons (ly:make-pitch 0 3 NATURAL) (x11-color &#39;yellow))
    (cons (ly:make-pitch 0 3 SHARP) (x11-color &#39;blue))
    (cons (ly:make-pitch 0 4 FLAT) (x11-color &#39;blue))
    (cons (ly:make-pitch 0 4 SHARP) (x11-color &#39;red))
    (cons (ly:make-pitch 0 4 NATURAL) (x11-color &#39;red))
    (cons (ly:make-pitch 0 5 FLAT) (x11-color &#39;red))
    (cons (ly:make-pitch 0 5 NATURAL) (x11-color &#39;yellow))
    (cons (ly:make-pitch 0 5 SHARP) (x11-color &#39;blue))
    (cons (ly:make-pitch 0 6 FLAT) (x11-color &#39;blue))
    (cons (ly:make-pitch 0 6 SHARP) (x11-color &#39;red))
    (cons (ly:make-pitch 0 6 NATURAL) (x11-color &#39;red))
    ))

%Compare pitch and alteration (not octave).
#(define (pitch-equals? p1 p2)
   (and
    (= (ly:pitch-alteration p1) (ly:pitch-alteration p2))
    (= (ly:pitch-notename p1) (ly:pitch-notename p2))))

#(define (pitch-to-color pitch)
   (let ((color (assoc pitch color-mapping pitch-equals?)))
     (if color
         (cdr color))))

#(define (color-notehead grob)
   (pitch-to-color
    (ly:event-property (event-cause grob) &#39;pitch)))


\layout {
  \context {
    \Voice
    \remove &#34;Note_heads_engraver&#34;
    \consists &#34;Completion_heads_engraver&#34;
    \remove &#34;Rest_engraver&#34;
    \consists &#34;Completion_rest_engraver&#34;
  }
}

trackAchannelA = {

  \time 2/4

  \tempo 4 = 100

}

trackA = &lt;&lt;
  \context Voice = voiceA \trackAchannelA
&gt;&gt;


trackBchannelA = {
  \skip 4*6432/240
}

trackBchannelB = \relative c {
    \override NoteHead.color = #color-notehead

g&#39;&#39;4*96/240 g4*96/240 a4*96/240 a4*96/240

  g4*192/240

  g4*96/240 g4*96/240 a4*96/240 a4*96/240

  g4*192/240
  g4*96/240 g4*96/240 a4*96/240 a4*96/240

  g4*192/240
  g4*96/240 g4*96/240 a4*96/240 a4*96/240

  g4*192/240
  g4*96/240 g4*96/240 a4*96/240 a4*96/240

  a4*192/240
  g4*96/240 g4*96/240 a4*96/240 d4*96/240

  g,4*192/240 g4*96/240
  a4*96/240 g4*96/240 a4*96/240 d4*96/240

  g,4*192/240
}

trackB = &lt;&lt;
  \context Voice = voiceA \trackBchannelA
  \context Voice = voiceB \trackBchannelB
&gt;&gt;


\score {
  &lt;&lt;
    \context Staff=trackB \trackA
    \context Staff=trackB \trackB
  &gt;&gt;
  \layout {}
  \midi {}
}
</code></pre><p>And it generates the following image.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>lilypond -o cochon --png cochon-midi.ly
</span></span></code></pre></div><figure><img src="https://konubinix.eu/ipfs/bafkreihmcfnc4cooixzcdg3244yvarvueplyed24dlebxdmvdtigecisqe?filename=a.png">
</figure>

<h2 id="play-some-of-my-favorite-musics">play some of my favorite musics</h2>
<p>For instance, <a href="https://konubinix.eu/ipfs/bafkreig5pppx7ddvpdg3knpgvhudwwmwneokdr6nfsooo3msclr2apwrgq">cosmo canyon</a>.</p>
<p>By playing a bit with the generated lilypond score, I get this result.</p>
<p><a href="https://konubinix.eu/ipfs/bafkreib7racm6debadckokgqwpxkzj7dzdp5yb6ptlhp5dvjon77klnjxm?filename=canyon_midi.ly">canyon-midi.ly</a></p>
<p>And it generates this sheet.</p>
<p><a href="https://konubinix.eu/ipfs/bafkreibpwnpnfmsliwy2jjrdsl6fhltctgs622wdjlj7zoeeoyrg22eizm?filename=canyon_page1.png">canyon-page1.png</a></p>
<p><a href="https://konubinix.eu/ipfs/bafkreihy42daxnbnxrbartlclzf6nhndvdjubyc45ycazy7g4ehuednija?filename=canyon_page2.png">canyon-page2.png</a></p>
<p><a href="https://konubinix.eu/ipfs/bafkreiaiswcjdvpzvfjvvw4mnpovnupk47xms53bpulo2vaxxf6y2de7j4?filename=canyon_page3.png">canyon-page3.png</a></p>
<p><a href="https://konubinix.eu/ipfs/bafkreiczt7wnthilzq66q2xust5enh3aqctghq2ep64ffhqyyg4otnxv7i?filename=canyon_page4.png">canyon-page4.png</a></p>
<p><a href="https://konubinix.eu/ipfs/bafkreiah54ivlworoxsx5mn2ts6zrq6jive2pgrgscru5nw2faxox36oxq?filename=canyon_page5.png">canyon-page5.png</a></p>
<p>I colored the tracks to that I can see which notes I want to put in the clef F
and which ones in the clef G. Unfortunately, some tracks should be split into
both. That means that I should identify the notes interval to capture from one
track and to put into another track.</p>
<p>I found a sheet of Aeris&rsquo; theme.</p>
<p><a href="https://konubinix.eu/ipfs/bafkreiadnl5oushwalbuvqjcwhp4qevaazq2cs44cwsbrx3yjrwlsxlram?filename=aeris_theme_aerith_piano_sheet_music.pdf">Aeris-Theme-Aerith-piano-sheet-music.pdf</a></p>
<p>It helps having a reference to find out whether the conversion works well. On the other hand, the sheet is about the music reworked to be played in a piano, while the midi is not.</p>
<p><a href="https://konubinix.eu/ipfs/bafkreia5sedwif672guppyy33oqfxr7nliurupnw5bqfly6mdcvzpvszzi?filename=aeris.mid">aeris.mid</a></p>
<p><a href="https://konubinix.eu/ipfs/bafkreihi2o4gbnmgssawgybm4ce5zngejbwpfspfqhg3p5qesb47ztqbv4?filename=aeris_midi.ly">aeris-midi.ly</a></p>
<p>Just taking the few first pages</p>
<figure><img src="https://konubinix.eu/ipfs/bafkreifby3p5r5m7u457vafnf2jli4rswebcnsvhypz4i6lt4ksdffewha?filename=a.png">
</figure>

<figure><img src="https://konubinix.eu/ipfs/bafkreiagszuzzwdp7c6flhbu7usv2aofgjvpvb4gfxouz3ktjzfmcnib6e?filename=aeris_page2.png">
</figure>

<figure><img src="https://konubinix.eu/ipfs/bafkreiffepdmmkucygi2oggyb6qkjpsudqskagiir3zm5pdo2sgzw5ycme?filename=aeris_page3.png">
</figure>

<p>ðŸ¤”</p>
<h2 id="conclusion">conclusion</h2>
<p>It looks to me like going from midi to piano note sheets it harder than
looking for the piano sheet in the first place. <a href="/braindump/posts/guided_serendipity/">It was a nice</a> introduction to
understanding a bit more about music and how one can write piano sheets with
<a href="/braindump/posts/lilypond/">LilyPond</a>.</p>
<h2 id="permalink"><a href="https://konubinix.eu/braindump/3973fe25-7725-486d-9168-a7981d453176?title=midi_to_music_sheet_using_lilypond">Permalink</a></h2>
      </div>
	  <aside class="date"><time>Last updated: 07 Jun 2022</time></aside>
	  <aside class="date"><time>Published&nbsp;&nbsp;&nbsp;: 10 Jan 2022</time></aside>
    </div>
  </div>
</div>

<script src="/braindump/js/URI.js" type="text/javascript"></script>

<script src="/braindump/js/page.js" type="text/javascript"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>
