<!DOCTYPE html>
<html><title>using stepmania for new years eve</title>


<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="bLmaFyyXugiCqSup-eIIIx0B4CngtdF_svyMMKQbS5E" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=10, minimum-scale=0.5, user-scalable=yes">
<meta name="apple-mobile-web-app-capable" content="yes" />
<script src="https://hypothes.is/embed.js" async></script>


<link rel="stylesheet" href="/braindump/css/main.min.56b43bcbc759a196f9dd525bee62bdec45a29ba95902bbab74a4f7ad2ea3e8cb.css"/>

<link rel="stylesheet" href="/braindump/css/links.min.4bf1990b213fb76d2a66153dc6ef9a57d49f536c6baf6e7f19a7948470a38141.css"/>

<link rel="stylesheet" href="/braindump/css/konubinix.min.cf2d0f36945178c647979ee68f1830892e06aa3d481d8913728b5c7462b97f6e.css"/>

<link rel="stylesheet" href="/ipfs/QmQFVQS89fv1XUNFcjwCKDePzckuT9kpuAVNYUwNdEfYcv/css/all.css"/>
<link rel="shortcut icon" href="/ipfs/QmVFwYV7YRZLKU3ybN1hW4jqfyZGPLKJwd8toN2wHz5UAD?a.png" type="image/x-icon" />

<body><header>
  <div>
	<a href="/braindump//"><h5 class="site-title">Konubinix&#39; opinionated web of thoughts</h5></a>
  </div>
  <span>
	<a href="/blog/"><i class="icon fas fa-blog"></i></a>
	<a href="/braindump/posts/"><i class="icon fas fa-brain"></i></a>
    <a href="mailto:konubinixweb@gmail.com"><i class="icon fas fa-envelope-square"></i></a>
    <a href="https://github.com/konubinix"><i class="icon fab fa-github-square"></i></a>
    <a href="https://linkedin.com/in/samuel-loury-61259040"><i class="icon fab fa-linkedin"></i></a>
	<a href="/braindump/graph.html"><i class="icon fas fa-project-diagram"></i></a>
	<a href="/braindump/index.xml"><i class="icon fas fa-rss-square"></i></a>
	<a href="/braindump/tags/"><i class="icon fa fa-tag"></i></a>
	<a href="/braindump/braindump_search"><i class="icon fa fa-search"></i></a>
  </span>
</header>

<div class="grid-container">
  <div class="grid">
    <div class="page" data-level="1">
      <div class="content">
		<p class="lead">
        <h1>Using Stepmania for New Years Eve</h1>
		<span class="badge badge-pill badge-warning"><a href="/braindump/tags/fleeting/">Fleeting</a></span></p>
        <p>My challenge is to have a running <a href="/braindump/posts/stepmania/">stepmania</a> before <span class="timestamp-wrapper"><span class="timestamp">[2022-01-01 Sat]</span></span>.</p>
<h2 id="48b07405-060e-4b21-b6d7-21531923cbf9">Make the DDR dance mat work</h2>
<p>I have one of those:</p>
<figure><img src="https://konubinix.eu/ipfs/bafybeihbciqq7pjcb65dnyu2oz2vydsvo6izulwlxysmlhk6rsvalctrnm?filename=a.png">
</figure>

<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sudo dmesg |tail
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>[48795.837001] usb 1-1: new low-speed USB device number 15 using xhci_hcd
</span></span><span style="display:flex;"><span>[48795.987876] usb 1-1: New USB device found, idVendor=0079, idProduct=0011, bcdDevice= 1.06
</span></span><span style="display:flex;"><span>[48795.987880] usb 1-1: New USB device strings: Mfr=0, Product=2, SerialNumber=0
</span></span><span style="display:flex;"><span>[48795.987881] usb 1-1: Product: USB Gamepad
</span></span><span style="display:flex;"><span>[48796.002524] input: USB Gamepad  as /devices/pci0000:00/0000:00:14.0/usb1/1-1/1-1:1.0/0003:0079:0011.0007/input/input38
</span></span><span style="display:flex;"><span>[48796.002803] dragonrise 0003:0079:0011.0007: input,hidraw6: USB HID v1.10 Joystick [USB Gamepad ] on usb-0000:00:14.0-1/input0
</span></span><span style="display:flex;"><span>[48920.234137] usb 1-1: USB disconnect, device number 15
</span></span><span style="display:flex;"><span>[48954.023644] usb 1-1: new low-speed USB device number 16 using xhci_hcd
</span></span><span style="display:flex;"><span>[48954.175420] usb 1-1: New USB device found, idVendor=0079, idProduct=0011, bcdDevice= 1.06
</span></span><span style="display:flex;"><span>[48954.175435] usb 1-1: New USB device strings: Mfr=0, Product=2, SerialNumber=0
</span></span><span style="display:flex;"><span>[48954.175441] usb 1-1: Product: USB Gamepad
</span></span><span style="display:flex;"><span>[48954.181887] input: USB Gamepad  as /devices/pci0000:00/0000:00:14.0/usb1/1-1/1-1:1.0/0003:0079:0011.0008/input/input39
</span></span><span style="display:flex;"><span>[48954.182625] dragonrise 0003:0079:0011.0008: input,hidraw6: USB HID v1.10 Joystick [USB Gamepad ] on usb-0000:00:14.0-1/input0
</span></span></code></pre></div><p>The device appears to be ok.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ls /dev/input|gi js
</span></span><span style="display:flex;"><span>ls /dev/input/by-id|gi gamepad
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>js0
</span></span><span style="display:flex;"><span>usb-0079_USB_Gamepad-event-joystick
</span></span><span style="display:flex;"><span>usb-0079_USB_Gamepad-joystick
</span></span></code></pre></div><p>Great, it is recognized.</p>
<p>Now, to test whether it correctly sends data to my computer.</p>
<p>I run the following, but I think they actually were already loaded</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sudo modprobe joydev
</span></span><span style="display:flex;"><span>sudo modprobe analog
</span></span><span style="display:flex;"><span>sudo modprobe xpad
</span></span></code></pre></div><p>Then try it out with</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sudo apt install joystick
</span></span><span style="display:flex;"><span>jstest /dev/input/js0
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>âœ”  jstest /dev/input/js0
</span></span><span style="display:flex;"><span>Driver version is 2.1.0.
</span></span><span style="display:flex;"><span>Joystick (USB Gamepad ) has 2 axes (X, Y)
</span></span><span style="display:flex;"><span>and 10 buttons (Trigger, ThumbBtn, ThumbBtn2, TopBtn, TopBtn2, PinkieBtn, BaseBtn, BaseBtn2, BaseBtn3, BaseBtn4).
</span></span><span style="display:flex;"><span>Testing ... (interrupt to exit)
</span></span><span style="display:flex;"><span>Axes:  0:     0  1:     0 Buttons:  0:off  1:off  2:off  3:off  4:off  5:off  6:off  7:off  8:off  9:off
</span></span></code></pre></div><p>Walk on the button and see the values move from off to on.</p>
<h2 id="63f906f7-3f7b-41f2-b028-bced68afe3b2">Make the software work</h2>
<p>Stepmania is quite old and does not work anymore on recent linux.</p>
<p>Fortunately, someone already created a docker setup to emulate an old system.</p>
<p>I just don&rsquo;t like using root, even in a docker container, thus I used my usual snippet to create a user.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">ARG</span> <span style="color:#008080">uid</span><span style="color:#000;font-weight:bold">=</span><span style="color:#099">1000</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">ARG</span> <span style="color:#008080">username</span><span style="color:#000;font-weight:bold">=</span>sam
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">ENV</span> <span style="color:#008080">HOME</span><span style="color:#000;font-weight:bold">=</span>/home/<span style="color:#008080">$username</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#000;font-weight:bold">RUN</span> addgroup --gid <span style="color:#008080">$uid</span> --system <span style="color:#008080">$username</span> <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span><span style="color:#000;font-weight:bold">&amp;&amp;</span> adduser --uid <span style="color:#008080">$uid</span> --system <span style="color:#008080">$username</span> --ingroup <span style="color:#008080">$username</span> <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span><span style="color:#000;font-weight:bold">&amp;&amp;</span> addgroup --system <span style="color:#008080">$username</span> audio <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span><span style="color:#000;font-weight:bold">&amp;&amp;</span> addgroup --system <span style="color:#008080">$username</span> video <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span><span style="color:#000;font-weight:bold">&amp;&amp;</span> addgroup --system <span style="color:#008080">$username</span> disk <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span><span style="color:#000;font-weight:bold">&amp;&amp;</span> addgroup --system <span style="color:#008080">$username</span> lp <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span><span style="color:#000;font-weight:bold">&amp;&amp;</span> addgroup --system <span style="color:#008080">$username</span> dialout <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span><span style="color:#000;font-weight:bold">&amp;&amp;</span> addgroup --system <span style="color:#008080">$username</span> users <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span><span style="color:#000;font-weight:bold">&amp;&amp;</span> chown -R <span style="color:#008080">$username</span>:<span style="color:#008080">$username</span> <span style="color:#008080">$HOME</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#000;font-weight:bold">ENV</span> <span style="color:#008080">PATH</span><span style="color:#000;font-weight:bold">=</span><span style="color:#008080">$HOME</span>/.local/bin:<span style="color:#008080">$PATH</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#000;font-weight:bold">ARG</span> <span style="color:#008080">uid</span><span style="color:#000;font-weight:bold">=</span><span style="color:#099">1000</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">ARG</span> <span style="color:#008080">username</span><span style="color:#000;font-weight:bold">=</span>sam
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">ENV</span> <span style="color:#008080">HOME</span><span style="color:#000;font-weight:bold">=</span>/home/<span style="color:#008080">$username</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#000;font-weight:bold">USER</span><span style="color:#d14"> $username</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#000;font-weight:bold">WORKDIR</span><span style="color:#d14"> $HOME</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span></code></pre></div><p>I does more than needed, but this is a one size fit all snippet that works well everytime.</p>
<p>Then, I just run the xhost as indicated to share my X session</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>xhost +local:docker
</span></span></code></pre></div><p>And simply run the program with</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>docker run --name stepmania -it --rm <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>       -v /tmp/.X11-unix:/tmp/.X11-unix <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>       -v /home/sam/stepmania:<span style="color:#d14">${</span><span style="color:#008080">HOME</span><span style="color:#d14">}</span>/.stepmania-5.0 <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>       -v /run/user/<span style="color:#008080">$UID</span>/pulse/native:/tmp/pulseaudio.socket <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>       -e <span style="color:#008080">DISPLAY</span><span style="color:#000;font-weight:bold">=</span><span style="color:#008080">$DISPLAY</span> <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>       -e <span style="color:#008080">PULSE_SERVER</span><span style="color:#000;font-weight:bold">=</span>unix:/tmp/pulseaudio.socket <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>       -v <span style="color:#d14">${</span><span style="color:#008080">HOME</span><span style="color:#d14">}</span>/.config/pulse/cookie:/run/pulse/cookie <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>       --device /dev/snd <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>       --device /dev/input/js0 <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>       stepmania
</span></span></code></pre></div><p>Then it simply works.</p>
<h2 id="93533485-8c52-478a-beef-d2ddf0f0eb1f">Configure the mat in stepmania</h2>
<p>My setup looks like this</p>
<figure><img src="https://konubinix.eu/ipfs/bafybeiay52fw7t7c7wcp6e4q7uxpnn2cr7mhpj4fq4qgatbdh6jgrfxrtm?filename=a.png">
</figure>

<p>Or, in <code>~/stepmania/Save/Keymaps.ini</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>[dance]
</span></span><span style="display:flex;"><span>1_Back=Joy1_B6:Key_escape
</span></span><span style="display:flex;"><span>1_Coin=
</span></span><span style="display:flex;"><span>1_Down=:Joy1_B2
</span></span><span style="display:flex;"><span>1_EffectDown=
</span></span><span style="display:flex;"><span>1_EffectUp=
</span></span><span style="display:flex;"><span>1_Left=:Joy1_B1
</span></span><span style="display:flex;"><span>1_MenuDown=
</span></span><span style="display:flex;"><span>1_MenuLeft=
</span></span><span style="display:flex;"><span>1_MenuRight=
</span></span><span style="display:flex;"><span>1_MenuUp=
</span></span><span style="display:flex;"><span>1_Operator=
</span></span><span style="display:flex;"><span>1_Right=:Joy1_B4
</span></span><span style="display:flex;"><span>1_Select=:Joy1_B9
</span></span><span style="display:flex;"><span>1_Start=:Joy1_B10
</span></span><span style="display:flex;"><span>1_Up=:Joy1_B3
</span></span><span style="display:flex;"><span>1_UpLeft=:Joy1_B7
</span></span><span style="display:flex;"><span>1_UpRight=:Joy1_B8
</span></span><span style="display:flex;"><span>2_Back=
</span></span><span style="display:flex;"><span>2_Coin=
</span></span><span style="display:flex;"><span>2_Down=
</span></span><span style="display:flex;"><span>2_EffectDown=
</span></span><span style="display:flex;"><span>2_EffectUp=
</span></span><span style="display:flex;"><span>2_Left=
</span></span><span style="display:flex;"><span>2_MenuDown=
</span></span><span style="display:flex;"><span>2_MenuLeft=
</span></span><span style="display:flex;"><span>2_MenuRight=
</span></span><span style="display:flex;"><span>2_MenuUp=
</span></span><span style="display:flex;"><span>2_Operator=
</span></span><span style="display:flex;"><span>2_Right=
</span></span><span style="display:flex;"><span>2_Select=
</span></span><span style="display:flex;"><span>2_Start=
</span></span><span style="display:flex;"><span>2_Up=
</span></span><span style="display:flex;"><span>2_UpLeft=
</span></span><span style="display:flex;"><span>2_UpRight=
</span></span></code></pre></div><h2 id="70a1bedd-bf08-46dc-b410-6ac0fece98bb">Setup the sound over HDMI</h2>
<p>I definitely had the issue <a href="/braindump/posts/hdmi_recognized_as_unplugged/">mentioned here</a>.</p>
<figure><img src="https://konubinix.eu/ipfs/bafkreiej7daf4nqykroqezx6yolx2xgjrhejd6asolsxaaspi2gditc3hq?filename=a.png">
</figure>

<p>Getting out of X and in again made this profile available and the sound went over HDMI.</p>
<h2 id="55606a59-78e6-4cda-98fa-35ad3c38135d">Tweaking a bit the screen resolution</h2>
<p>In <code>~/stepmania/Save/Preferences.ini</code> I edit the screen width and screen height to fit with my projector.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>DisplayHeight=450
</span></span><span style="display:flex;"><span>DisplayWidth=800
</span></span></code></pre></div><h2 id="ab9d1c72-5887-4b34-91f1-0dd918cd9055">Adding songs</h2>
<p>Simply go to <a href="https://search.stepmaniaonline.net/">https://search.stepmaniaonline.net/</a>, there are several thousands of pack of songs.</p>
<p>Then download a pack, unzip it into <code>~/stepmania/Songs</code> and it becomes available in the stepmania song selection.</p>
<figure><img src="https://konubinix.eu/ipfs/bafkreidcqmppmd75mnbp2q7ltexph6rqt34dvud2cpdtpxqwytsud4m54u?filename=a.png">
</figure>

<h2 id="80bf3946-2c91-450d-8a3e-6faa40885bc3">Conclusion</h2>
<p><span class="timestamp-wrapper"><span class="timestamp">[2021-12-24 Fri] </span></span> It is ready even before Christmas!</p>
<h2 id="permalink"><a href="https://konubinix.eu/braindump/d11febee-9f8d-4997-8067-b1f2c38e574c?title=using_stepmania_for_new_years_eve">Permalink</a></h2>
      </div>
	  <aside class="date"><time>Last updated: 31 Dec 2024</time></aside>
	  <aside class="date"><time>Published&nbsp;&nbsp;&nbsp;: 23 Dec 2021</time></aside>
    </div>
  </div>
</div>

<script src="/braindump/js/URI.js" type="text/javascript"></script>

<script src="/braindump/js/page.js" type="text/javascript"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>
