<!DOCTYPE html>
<html><title>Attestation - SGX 101</title>


<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="bLmaFyyXugiCqSup-eIIIx0B4CngtdF_svyMMKQbS5E" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=10, minimum-scale=0.5, user-scalable=yes">
<meta name="apple-mobile-web-app-capable" content="yes" />
<script src="https://hypothes.is/embed.js" async></script>


<link rel="stylesheet" href="/braindump/css/main.min.56b43bcbc759a196f9dd525bee62bdec45a29ba95902bbab74a4f7ad2ea3e8cb.css"/>

<link rel="stylesheet" href="/braindump/css/links.min.4bf1990b213fb76d2a66153dc6ef9a57d49f536c6baf6e7f19a7948470a38141.css"/>

<link rel="stylesheet" href="/braindump/css/konubinix.min.cf2d0f36945178c647979ee68f1830892e06aa3d481d8913728b5c7462b97f6e.css"/>

<link rel="stylesheet" href="/ipfs/QmQFVQS89fv1XUNFcjwCKDePzckuT9kpuAVNYUwNdEfYcv/css/all.css"/>
<link rel="shortcut icon" href="/ipfs/QmVFwYV7YRZLKU3ybN1hW4jqfyZGPLKJwd8toN2wHz5UAD?a.png" type="image/x-icon" />

<body><header>
  <div>
	<a href="/braindump//"><h5 class="site-title">Konubinix&#39; opinionated web of thoughts</h5></a>
  </div>
  <span>
	<a href="/blog/"><i class="icon fas fa-blog"></i></a>
	<a href="/braindump/posts/"><i class="icon fas fa-brain"></i></a>
    <a href="mailto:konubinixweb@gmail.com"><i class="icon fas fa-envelope-square"></i></a>
    <a href="https://github.com/konubinix"><i class="icon fab fa-github-square"></i></a>
    <a href="https://linkedin.com/in/samuel-loury-61259040"><i class="icon fab fa-linkedin"></i></a>
	<a href="/braindump/graph.html"><i class="icon fas fa-project-diagram"></i></a>
	<a href="/braindump/index.xml"><i class="icon fas fa-rss-square"></i></a>
	<a href="/braindump/tags/"><i class="icon fa fa-tag"></i></a>
	<a href="/braindump/braindump_search"><i class="icon fa fa-search"></i></a>
  </span>
</header>

<div class="grid-container">
  <div class="grid">
    <div class="page" data-level="1">
      <div class="content">
		<p class="lead">
        <h1>Attestation - SGX 101</h1>
		<span class="badge badge-pill badge-warning"><a href="/braindump/tags/fleeting/">Fleeting</a></span></p>
        <ul>
<li>External reference: <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></li>
</ul>
<p>gi#+DATE: <span class="timestamp-wrapper"><span class="timestamp">[2020-12-30 Wed 17:29]</span></span></p>
<p><a href="/braindump/posts/attestation/">Attestation</a> - SGX 101</p>
<blockquote>
<figure><img src="https://konubinix.eu/ipfs/bafkreiefntlh4rura4kshgkabfgsuckh2b66st4c4pr3o2dlyegoo2jgni?filename=a.png">
</figure>

<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p><a href="/braindump/posts/measurement/">Enclave Measurement</a> (aka Software <a href="/braindump/posts/trusted_computing_base/">TCB</a>)</p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>one should first securely obtain the enclave’s software TCB, then securely
obtain the expected enclave’s software TCB and compare those two values</p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>REPORT Contains following data:
Measurement of the code and data in the enclave.</p>
<p>A hash of the public key in the ISV certificate presented at enclave initialization time.</p>
<p>User data.</p>
<p>Other security related state information (not described here).</p>
<p>A signature block over the above data, which can be verified by the same platform that produced the report.</p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Enclaves’ certificate is called SIGSTRUCT and is a mandatory supplement for launching any enclave</p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Intel is considered the primary enclave launch authority, however other entities
can be trusted by the platform owner to authorize launching of enclaves. The
respected launch authority is specified by its public key hash signed by Intel
and stored on the platform.</p>
</blockquote>
<!--quoteend-->
<blockquote>
<figure><img src="https://gblobscdn.gitbook.com/assets%2F-LhhJjEW6KpUr6O6ktt0%2F-LhmAtCdHlavdXBn7_8v%2F-LhmBg0BUplAWA3gEds3%2Fra.png?alt=media&amp;token=c330a403-da51-403a-ba2b-b2b680bb8ee4">
</figure>

<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<figure><img src="https://konubinix.eu/ipfs/bafkreia6ezamxonhpejb76ebj4d3f4gycfxyn3pwyd63ohui6kcni3uhou?filename=a.png">
</figure>

</blockquote>
<!--quoteend-->
<blockquote>
<p>SGX enabled <a href="/braindump/posts/independent_service_vendor/">ISV</a> client requests secrets from its ISV client, password management
service for example, the client have to prove to the server that the client
application is running on a trusted platform that can process the secrets
securely. Both of those two conditions require a proof of secured execution
environment, and Intel SGX refers to this proving process as attestation.</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Local <a href="/braindump/posts/attestation/">Attestation</a> and Remote Attestation</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>two device root keys that are fused to SGX CPU at production</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Root Provisioning Key (RPK)</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>randomly generated on a dedicated Hardware Security Module (HSM)</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>within a special purpose facility called <a href="/braindump/posts/intel_key_generation_facility/">Intel Key Generation Facility</a> (iKGF)
which is guaranteed to be a well-guarded offline production facility</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p><a href="/braindump/posts/root_sealing_key/">Root Sealing Key</a> (RSK)</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>randomly generated automatically inside the CPU during production to be
statistically different from part to part</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Enclave Measurement (aka Software TCB):</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>cryptographic log of all the build activities, including:Content: code, data,
stack, heapLocation of each page within the enclaveSecurity flags being used</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>The “<a href="/braindump/posts/enclave_identity/">Enclave Identity</a>”, which is a 256-bit hash digest of the log, is stored as <a href="/braindump/posts/mrenclave/">MRENCLAVE</a> as the enclave’s software TCB.</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>EGETKEY instruction to get derivatives of device keys. EGETKEY produces symmetric keys for different purposes depending on invoking enclave attributes and the requested key type</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Provisioning is the process by which an SGX device demonstrates to Intel its authenticity as well as its CPU SVN and other system components attributes, in order to receive an appropriate attestation key reflecting its SGX genuinely and TCB version</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Attestation key is the core asset in the SGX ecosystem</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>trust valid attestation signatures as an Intel signed certificate that guarantees the platform’s authenticity</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>dedicated online provisioning infrastructure. SGX provisioning and remote attestation protocol follows a group signature scheme developed by Intel called Enhanced Privacy ID (EPID)</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>The PvE is responsible for conducting the provisioning process on the platform against Intel’s online provisioning servers</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>The uniqueness of PvE and QE is based on their SIGSTRUCT certificates signed by Intel (MRSIGNER)</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>All pre-computed challenges are sent to Intel’s online servers to support the provisioning protocol.</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>IPS first validates the TCB proof using the value received from iKGF and continues the EPID Join protocol on success</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Remote Attestation software includes the application’s enclave, and the
Intel-provided <a href="/braindump/posts/quoting_enclave/">Quoting Enclave</a> (QE) and <a href="/braindump/posts/provisioning_enclave/">Provisioning Enclave</a> (PvE).</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>in general, the secrets provisioned to an enclave are lost when the enclave is
closed</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>The protocol Intel SGX uses differs from the regular <a href="/braindump/posts/sigma_protocol/">Sigma protocol</a> in that the
Intel SGX platform uses Intel <a href="/braindump/posts/intel_enhanced_privacy_id/">EPID</a> to authenticate while the service provider
uses Public Key Infrastructure (in regular Sigma, both parties use PKI)</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Trusted Computing Base (TCB)</p>
<p>An entity responsible for protecting the secret
provisioned to the enclave (both software and hardware).</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>There are mainly three platforms involved in Remote Attestation:</p>
<ul>
<li>The service provide (challenger)</li>
<li>The application with its enclave and its <a href="/braindump/posts/quoting_enclave/">QE</a></li>
<li><a href="/braindump/posts/intel_attestation_service/">Intel Attestation Service</a> (IAS) that verifies the enclave</li>
</ul>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>The attestation key is then used to compute two signatures of knowledge over the
platform’s identity signature <a href="/braindump/posts/mrenclave/">MRENCLAVE</a>. The first proves the identity signature
was signed with a key certified by Intel. The second is a non-revoked proof that
proves the key used for the identity signature does not create any of the
identity signatures listed in the challenged SigRL.</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>A final QUOTE is then generated and encrypted using <a href="/braindump/posts/intel_attestation_service/">IAS</a>’s public key, which is
hardcoded in <a href="/braindump/posts/quoting_enclave/">QE</a>, and the result is sent back to the attesting enclave. The QUOTE
holds the identity of the attesting enclave, execution mode details (e.g. SVN
level) and additional data.</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>the ServiceProvider Application itself. Similar to the client’s application, it
has its own message handler VerificationManager since it acts as the verifier
in the remote attestation process.</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>has a WebService object to performs the verification phase with Intel
Attestation Service (<a href="/braindump/posts/intel_attestation_service/">IAS</a>) using the QUOTE sent from the client enclave. In one
word, a ServicePrivider also acts as a wrapper of all the IAS requests and
message processing, as well as any encryption key derivation, using WebService.</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Relying parties are referred to as service providers and do not have to hold <a href="/braindump/posts/attestation_sgx_101/">SGX</a>
enabled hardware. Service providers are expected to register to the IAS and meet
a set of Intel defined requirements in order to submit attestation evidence for
IAS verification. This registration binds service providers’ Transport Layer
Security (TLS) certificate to a unique Service Provider ID (SPID), and permits
access to the <a href="/braindump/posts/intel_attestation_service/">IAS</a> services. Some of these main IAS services are: verifying <a href="/braindump/posts/independent_service_vendor/">ISV</a>
enclave Quotes, requesting updated attestation revocation lists and retrieving
the assertion information history associated with a Quote</p>
<p>&mdash; <a href="https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation">https://sgx101.gitbook.io/sgx101/sgx-bootstrap/attestation</a></p>
</blockquote>
<!--more-->
<h2 id="notes-linking-here">Notes linking here</h2>
<ul>
<li><a href="/braindump/posts/sgx_101/">sgx 101</a></li>
</ul>
<h2 id="permalink"><a href="https://konubinix.eu/braindump/a8131d86-6ff1-4a24-b8fd-31814f19e4c2?title=attestation_sgx_101">Permalink</a></h2>
      </div>
	  <aside class="date"><time>Last updated: 10 Aug 2021</time></aside>
	  <aside class="date"><time>Published&nbsp;&nbsp;&nbsp;: 30 Dec 2020</time></aside>
    </div>
  </div>
</div>

<script src="/braindump/js/URI.js" type="text/javascript"></script>

<script src="/braindump/js/page.js" type="text/javascript"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>
