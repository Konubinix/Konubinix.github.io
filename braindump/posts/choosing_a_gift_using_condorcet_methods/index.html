<!DOCTYPE html>
<html><title>choosing a gift using condorcet methods</title>


<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="bLmaFyyXugiCqSup-eIIIx0B4CngtdF_svyMMKQbS5E" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=10, minimum-scale=0.5, user-scalable=yes">
<meta name="apple-mobile-web-app-capable" content="yes" />
<script src="https://hypothes.is/embed.js" async></script>


<link rel="stylesheet" href="/braindump/css/main.min.56b43bcbc759a196f9dd525bee62bdec45a29ba95902bbab74a4f7ad2ea3e8cb.css"/>

<link rel="stylesheet" href="/braindump/css/links.min.4bf1990b213fb76d2a66153dc6ef9a57d49f536c6baf6e7f19a7948470a38141.css"/>

<link rel="stylesheet" href="/braindump/css/konubinix.min.cf2d0f36945178c647979ee68f1830892e06aa3d481d8913728b5c7462b97f6e.css"/>

<link rel="stylesheet" href="/ipfs/QmQFVQS89fv1XUNFcjwCKDePzckuT9kpuAVNYUwNdEfYcv/css/all.css"/>
<link rel="shortcut icon" href="/ipfs/QmVFwYV7YRZLKU3ybN1hW4jqfyZGPLKJwd8toN2wHz5UAD?a.png" type="image/x-icon" />

<body><header>
  <div>
	<a href="/braindump//"><h5 class="site-title">Konubinix&#39; opinionated web of thoughts</h5></a>
  </div>
  <span>
	<a href="/blog/"><i class="icon fas fa-blog"></i></a>
	<a href="/braindump/posts/"><i class="icon fas fa-brain"></i></a>
    <a href="mailto:konubinixweb@gmail.com"><i class="icon fas fa-envelope-square"></i></a>
    <a href="https://github.com/konubinix"><i class="icon fab fa-github-square"></i></a>
    <a href="https://linkedin.com/in/samuel-loury-61259040"><i class="icon fab fa-linkedin"></i></a>
	<a href="/braindump/graph.html"><i class="icon fas fa-project-diagram"></i></a>
	<a href="/braindump/index.xml"><i class="icon fas fa-rss-square"></i></a>
	<a href="/braindump/tags/"><i class="icon fa fa-tag"></i></a>
	<a href="/braindump/braindump_search"><i class="icon fa fa-search"></i></a>
  </span>
</header>

<div class="grid-container">
  <div class="grid">
    <div class="page" data-level="1">
      <div class="content">
		<p class="lead">
        <h1>Choosing a Gift Using Condorcet Methods</h1>
		<span class="badge badge-pill badge-warning"><a href="/braindump/tags/fleeting/">Fleeting</a></span></p>
        <p>choosing a gift using</p>
<p>A group of three persons needed to choose a gift among 7 candidates.</p>
<p>I got an order on preferences</p>
<p><a id="table--raw-votes"></a></p>
<table>
  <thead>
      <tr>
          <th>person 1</th>
          <th>person 2</th>
          <th>person 3</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>5</td>
          <td>3</td>
          <td>4</td>
      </tr>
      <tr>
          <td>2</td>
          <td>4</td>
          <td>6</td>
      </tr>
      <tr>
          <td>6</td>
          <td>1</td>
          <td>5</td>
      </tr>
      <tr>
          <td>7</td>
          <td>7</td>
          <td>7</td>
      </tr>
      <tr>
          <td>1</td>
          <td>2</td>
          <td>1</td>
      </tr>
      <tr>
          <td>3</td>
          <td>6</td>
          <td>3</td>
      </tr>
      <tr>
          <td>4</td>
          <td>5</td>
          <td>2</td>
      </tr>
  </tbody>
</table>
<p>I intuitively cannot identify a clear winner. Let&rsquo;s try to find one using a
<a href="/braindump/posts/condorcet_method/">Condorcet method</a>.</p>
<h2 id="data-preparation">data preparation</h2>
<p>I need to transpose the table to more easily digest them in the following code blocks.</p>
<p><a id="code-snippet--votes"></a></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">return</span> <span style="color:#0086b3">list</span>(<span style="color:#0086b3">zip</span>(<span style="color:#000;font-weight:bold">*</span>v[<span style="color:#099">1</span>:]))
</span></span></code></pre></div><table>
  <thead>
      <tr>
          <th>5</th>
          <th>2</th>
          <th>6</th>
          <th>7</th>
          <th>1</th>
          <th>3</th>
          <th>4</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>3</td>
          <td>4</td>
          <td>1</td>
          <td>7</td>
          <td>2</td>
          <td>6</td>
          <td>5</td>
      </tr>
      <tr>
          <td>4</td>
          <td>6</td>
          <td>5</td>
          <td>7</td>
          <td>1</td>
          <td>3</td>
          <td>2</td>
      </tr>
  </tbody>
</table>
<h2 id="using-https-pypi-dot-org-project-condorcet">using <a href="https://pypi.org/project/condorcet/">https://pypi.org/project/condorcet/</a></h2>
<p>First, convert the data in something that the lib understands.</p>
<p><a id="code-snippet--condorcet-votes"></a></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">import</span> <span style="color:#555">json</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">return</span> json<span style="color:#000;font-weight:bold">.</span>dumps([
</span></span><span style="display:flex;"><span>    {b: i<span style="color:#000;font-weight:bold">+</span><span style="color:#099">1</span> <span style="color:#000;font-weight:bold">for</span> i, b <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">enumerate</span>(a)}
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">for</span> a <span style="color:#000;font-weight:bold">in</span> votes
</span></span><span style="display:flex;"><span>])
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>[{&#34;5&#34;: 1, &#34;2&#34;: 2, &#34;6&#34;: 3, &#34;7&#34;: 4, &#34;1&#34;: 5, &#34;3&#34;: 6, &#34;4&#34;: 7}, {&#34;3&#34;: 1, &#34;4&#34;: 2, &#34;1&#34;: 3, &#34;7&#34;: 4, &#34;2&#34;: 5, &#34;6&#34;: 6, &#34;5&#34;: 7}, {&#34;4&#34;: 1, &#34;6&#34;: 2, &#34;5&#34;: 3, &#34;7&#34;: 4, &#34;1&#34;: 5, &#34;3&#34;: 6, &#34;2&#34;: 7}]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">import</span> <span style="color:#555">condorcet</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">import</span> <span style="color:#555">json</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">from</span> <span style="color:#555">clk.lib</span> <span style="color:#000;font-weight:bold">import</span> json_dumps
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">return</span> json_dumps(condorcet<span style="color:#000;font-weight:bold">.</span>CondorcetEvaluator(candidates<span style="color:#000;font-weight:bold">=</span>[<span style="color:#0086b3">str</span>(i) <span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(<span style="color:#099">1</span>, <span style="color:#099">8</span>)], votes<span style="color:#000;font-weight:bold">=</span>json<span style="color:#000;font-weight:bold">.</span>loads(votes))<span style="color:#000;font-weight:bold">.</span>get_n_winners(<span style="color:#099">2</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>[
</span></span><span style="display:flex;"><span>    [],
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        &#34;1&#34;: {
</span></span><span style="display:flex;"><span>            &#34;losses&#34;: [
</span></span><span style="display:flex;"><span>                &#34;4&#34;,
</span></span><span style="display:flex;"><span>                &#34;5&#34;,
</span></span><span style="display:flex;"><span>                &#34;6&#34;,
</span></span><span style="display:flex;"><span>                &#34;7&#34;
</span></span><span style="display:flex;"><span>            ],
</span></span><span style="display:flex;"><span>            &#34;wins&#34;: [
</span></span><span style="display:flex;"><span>                &#34;2&#34;,
</span></span><span style="display:flex;"><span>                &#34;3&#34;
</span></span><span style="display:flex;"><span>            ]
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        &#34;2&#34;: {
</span></span><span style="display:flex;"><span>            &#34;losses&#34;: [
</span></span><span style="display:flex;"><span>                &#34;1&#34;,
</span></span><span style="display:flex;"><span>                &#34;3&#34;,
</span></span><span style="display:flex;"><span>                &#34;4&#34;,
</span></span><span style="display:flex;"><span>                &#34;5&#34;,
</span></span><span style="display:flex;"><span>                &#34;7&#34;
</span></span><span style="display:flex;"><span>            ],
</span></span><span style="display:flex;"><span>            &#34;wins&#34;: [
</span></span><span style="display:flex;"><span>                &#34;6&#34;
</span></span><span style="display:flex;"><span>            ]
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        &#34;3&#34;: {
</span></span><span style="display:flex;"><span>            &#34;losses&#34;: [
</span></span><span style="display:flex;"><span>                &#34;1&#34;,
</span></span><span style="display:flex;"><span>                &#34;5&#34;,
</span></span><span style="display:flex;"><span>                &#34;6&#34;,
</span></span><span style="display:flex;"><span>                &#34;7&#34;
</span></span><span style="display:flex;"><span>            ],
</span></span><span style="display:flex;"><span>            &#34;wins&#34;: [
</span></span><span style="display:flex;"><span>                &#34;2&#34;,
</span></span><span style="display:flex;"><span>                &#34;4&#34;
</span></span><span style="display:flex;"><span>            ]
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        &#34;4&#34;: {
</span></span><span style="display:flex;"><span>            &#34;losses&#34;: [
</span></span><span style="display:flex;"><span>                &#34;3&#34;
</span></span><span style="display:flex;"><span>            ],
</span></span><span style="display:flex;"><span>            &#34;wins&#34;: [
</span></span><span style="display:flex;"><span>                &#34;1&#34;,
</span></span><span style="display:flex;"><span>                &#34;2&#34;,
</span></span><span style="display:flex;"><span>                &#34;5&#34;,
</span></span><span style="display:flex;"><span>                &#34;6&#34;,
</span></span><span style="display:flex;"><span>                &#34;7&#34;
</span></span><span style="display:flex;"><span>            ]
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        &#34;5&#34;: {
</span></span><span style="display:flex;"><span>            &#34;losses&#34;: [
</span></span><span style="display:flex;"><span>                &#34;4&#34;,
</span></span><span style="display:flex;"><span>                &#34;6&#34;
</span></span><span style="display:flex;"><span>            ],
</span></span><span style="display:flex;"><span>            &#34;wins&#34;: [
</span></span><span style="display:flex;"><span>                &#34;1&#34;,
</span></span><span style="display:flex;"><span>                &#34;2&#34;,
</span></span><span style="display:flex;"><span>                &#34;3&#34;,
</span></span><span style="display:flex;"><span>                &#34;7&#34;
</span></span><span style="display:flex;"><span>            ]
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        &#34;6&#34;: {
</span></span><span style="display:flex;"><span>            &#34;losses&#34;: [
</span></span><span style="display:flex;"><span>                &#34;2&#34;,
</span></span><span style="display:flex;"><span>                &#34;4&#34;
</span></span><span style="display:flex;"><span>            ],
</span></span><span style="display:flex;"><span>            &#34;wins&#34;: [
</span></span><span style="display:flex;"><span>                &#34;1&#34;,
</span></span><span style="display:flex;"><span>                &#34;3&#34;,
</span></span><span style="display:flex;"><span>                &#34;5&#34;,
</span></span><span style="display:flex;"><span>                &#34;7&#34;
</span></span><span style="display:flex;"><span>            ]
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        &#34;7&#34;: {
</span></span><span style="display:flex;"><span>            &#34;losses&#34;: [
</span></span><span style="display:flex;"><span>                &#34;4&#34;,
</span></span><span style="display:flex;"><span>                &#34;5&#34;,
</span></span><span style="display:flex;"><span>                &#34;6&#34;
</span></span><span style="display:flex;"><span>            ],
</span></span><span style="display:flex;"><span>            &#34;wins&#34;: [
</span></span><span style="display:flex;"><span>                &#34;1&#34;,
</span></span><span style="display:flex;"><span>                &#34;2&#34;,
</span></span><span style="display:flex;"><span>                &#34;3&#34;
</span></span><span style="display:flex;"><span>            ]
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div><p>Hmm, there appears to be no clear winner. What about a <a href="/braindump/posts/smith_set/">Smith set</a>?</p>
<h2 id="using-borda">using borda</h2>
<p>from <a href="https://stackoverflow.com/questions/9242450/borda-count-using-python">https://stackoverflow.com/questions/9242450/borda-count-using-python</a></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">import</span> <span style="color:#555">itertools</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">import</span> <span style="color:#555">collections</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">from</span> <span style="color:#555">clk.lib</span> <span style="color:#000;font-weight:bold">import</span> json_dumps
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">def</span> <span style="color:#900;font-weight:bold">borda</span>(ballot):
</span></span><span style="display:flex;"><span>    n <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">len</span>([c <span style="color:#000;font-weight:bold">for</span> c <span style="color:#000;font-weight:bold">in</span> ballot <span style="color:#000;font-weight:bold">if</span> c<span style="color:#000;font-weight:bold">.</span>isalpha()]) <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">1</span>
</span></span><span style="display:flex;"><span>    score <span style="color:#000;font-weight:bold">=</span> itertools<span style="color:#000;font-weight:bold">.</span>count(n, step <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>)
</span></span><span style="display:flex;"><span>    result <span style="color:#000;font-weight:bold">=</span> {}
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">for</span> group <span style="color:#000;font-weight:bold">in</span> [item<span style="color:#000;font-weight:bold">.</span>split(<span style="color:#d14">&#39;=&#39;</span>) <span style="color:#000;font-weight:bold">for</span> item <span style="color:#000;font-weight:bold">in</span> ballot<span style="color:#000;font-weight:bold">.</span>split(<span style="color:#d14">&#39;&gt;&#39;</span>)]:
</span></span><span style="display:flex;"><span>        s <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">sum</span>(<span style="color:#0086b3">next</span>(score) <span style="color:#000;font-weight:bold">for</span> item <span style="color:#000;font-weight:bold">in</span> group)<span style="color:#000;font-weight:bold">/</span><span style="color:#0086b3">float</span>(<span style="color:#0086b3">len</span>(group))
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">for</span> pref <span style="color:#000;font-weight:bold">in</span> group:
</span></span><span style="display:flex;"><span>            result[pref] <span style="color:#000;font-weight:bold">=</span> s
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> result
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">def</span> <span style="color:#900;font-weight:bold">tally</span>(ballots):
</span></span><span style="display:flex;"><span>    result <span style="color:#000;font-weight:bold">=</span> collections<span style="color:#000;font-weight:bold">.</span>defaultdict(<span style="color:#0086b3">int</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">for</span> ballot <span style="color:#000;font-weight:bold">in</span> ballots:
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">for</span> pref,score <span style="color:#000;font-weight:bold">in</span> borda(ballot)<span style="color:#000;font-weight:bold">.</span>items():
</span></span><span style="display:flex;"><span>            result[pref]<span style="color:#000;font-weight:bold">+=</span>score
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#0086b3">dict</span>(result)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ballots <span style="color:#000;font-weight:bold">=</span> [
</span></span><span style="display:flex;"><span>           <span style="color:#d14">&#39;&gt;&#39;</span><span style="color:#000;font-weight:bold">.</span>join(<span style="color:#0086b3">str</span>(v) <span style="color:#000;font-weight:bold">for</span> v <span style="color:#000;font-weight:bold">in</span> vote)
</span></span><span style="display:flex;"><span>           <span style="color:#000;font-weight:bold">for</span> vote <span style="color:#000;font-weight:bold">in</span> votes
</span></span><span style="display:flex;"><span>           ]
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">return</span>(json_dumps(<span style="color:#0086b3">sorted</span>([(k, v) <span style="color:#000;font-weight:bold">for</span> k, v <span style="color:#000;font-weight:bold">in</span> tally(ballots)<span style="color:#000;font-weight:bold">.</span>items()], key<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">lambda</span> a: <span style="color:#000;font-weight:bold">-</span>a[<span style="color:#099">1</span>])))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>[
</span></span><span style="display:flex;"><span>    [
</span></span><span style="display:flex;"><span>        &#34;4&#34;,
</span></span><span style="display:flex;"><span>        -10.0
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>    [
</span></span><span style="display:flex;"><span>        &#34;5&#34;,
</span></span><span style="display:flex;"><span>        -11.0
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>    [
</span></span><span style="display:flex;"><span>        &#34;6&#34;,
</span></span><span style="display:flex;"><span>        -11.0
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>    [
</span></span><span style="display:flex;"><span>        &#34;7&#34;,
</span></span><span style="display:flex;"><span>        -12.0
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>    [
</span></span><span style="display:flex;"><span>        &#34;1&#34;,
</span></span><span style="display:flex;"><span>        -13.0
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>    [
</span></span><span style="display:flex;"><span>        &#34;3&#34;,
</span></span><span style="display:flex;"><span>        -13.0
</span></span><span style="display:flex;"><span>    ],
</span></span><span style="display:flex;"><span>    [
</span></span><span style="display:flex;"><span>        &#34;2&#34;,
</span></span><span style="display:flex;"><span>        -14.0
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div><p>According to this voting system, the winner is 4 and the second place either 5 or 6.</p>
<h2 id="permalink"><a href="https://konubinix.eu/braindump/24aa8483-1c20-48d4-a7a9-92df2908ae29?title=choosing_a_gift_using_condorcet_methods">Permalink</a></h2>
      </div>
	  <aside class="date"><time>Last updated: 16 Mar 2023</time></aside>
	  <aside class="date"><time>Published&nbsp;&nbsp;&nbsp;: 03 Mar 2023</time></aside>
    </div>
  </div>
</div>

<script src="/braindump/js/URI.js" type="text/javascript"></script>

<script src="/braindump/js/page.js" type="text/javascript"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>
