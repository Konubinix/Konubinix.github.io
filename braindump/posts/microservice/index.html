<!DOCTYPE html>
<html><title>microservice</title>


<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="bLmaFyyXugiCqSup-eIIIx0B4CngtdF_svyMMKQbS5E" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=10, minimum-scale=0.5, user-scalable=yes">
<meta name="apple-mobile-web-app-capable" content="yes" />
<script src="https://hypothes.is/embed.js" async></script>


<link rel="stylesheet" href="/braindump/css/main.min.56b43bcbc759a196f9dd525bee62bdec45a29ba95902bbab74a4f7ad2ea3e8cb.css"/>

<link rel="stylesheet" href="/braindump/css/links.min.4bf1990b213fb76d2a66153dc6ef9a57d49f536c6baf6e7f19a7948470a38141.css"/>

<link rel="stylesheet" href="/braindump/css/konubinix.min.cf2d0f36945178c647979ee68f1830892e06aa3d481d8913728b5c7462b97f6e.css"/>

<link rel="stylesheet" href="/ipfs/QmQFVQS89fv1XUNFcjwCKDePzckuT9kpuAVNYUwNdEfYcv/css/all.css"/>
<link rel="shortcut icon" href="/ipfs/QmVFwYV7YRZLKU3ybN1hW4jqfyZGPLKJwd8toN2wHz5UAD?a.png" type="image/x-icon" />

<body><header>
  <div>
	<a href="/braindump//"><h5 class="site-title">Konubinix&#39; opinionated web of thoughts</h5></a>
  </div>
  <span>
	<a href="/blog/"><i class="icon fas fa-blog"></i></a>
	<a href="/braindump/posts/"><i class="icon fas fa-brain"></i></a>
    <a href="mailto:konubinixweb@gmail.com"><i class="icon fas fa-envelope-square"></i></a>
    <a href="https://github.com/konubinix"><i class="icon fab fa-github-square"></i></a>
    <a href="https://linkedin.com/in/samuel-loury-61259040"><i class="icon fab fa-linkedin"></i></a>
	<a href="/braindump/graph.html"><i class="icon fas fa-project-diagram"></i></a>
	<a href="/braindump/index.xml"><i class="icon fas fa-rss-square"></i></a>
	<a href="/braindump/tags/"><i class="icon fa fa-tag"></i></a>
	<a href="/braindump/braindump_search"><i class="icon fa fa-search"></i></a>
  </span>
</header>

<div class="grid-container">
  <div class="grid">
    <div class="page" data-level="1">
      <div class="content">
		<p class="lead">
        <h1>Microservice</h1>
		<span class="badge badge-pill badge-warning"><a href="/braindump/tags/fleeting/">Fleeting</a></span></p>
        <ul>
<li>External reference: <a href="https://microservices.io/patterns/data/transaction-log-tailing.html">https://microservices.io/patterns/data/transaction-log-tailing.html</a></li>
<li>External reference: <a href="https://microservices.io/patterns/data/transactional-outbox.html">https://microservices.io/patterns/data/transactional-outbox.html</a></li>
<li>External reference: <a href="https://microservices.io/patterns/data/aggregate.html">https://microservices.io/patterns/data/aggregate.html</a></li>
<li>External reference: <a href="https://microservices.io/patterns/data/domain-event.html">https://microservices.io/patterns/data/domain-event.html</a></li>
<li>External reference: <a href="https://microservices.io/patterns/data/event-sourcing.html">https://microservices.io/patterns/data/event-sourcing.html</a></li>
<li>External reference: <a href="https://microservices.io/patterns/data/cqrs.html">https://microservices.io/patterns/data/cqrs.html</a></li>
<li>External reference: <a href="https://microservices.io/patterns/server-side-discovery.html">https://microservices.io/patterns/server-side-discovery.html</a></li>
<li>External reference: <a href="https://microservices.io/patterns/service-registry.html">https://microservices.io/patterns/service-registry.html</a></li>
<li>External reference: <a href="https://microservices.io/patterns/microservice-chassis.html">https://microservices.io/patterns/microservice-chassis.html</a></li>
<li>External reference: <a href="https://microservices.io/patterns/client-side-discovery.html">https://microservices.io/patterns/client-side-discovery.html</a></li>
<li>External reference: <a href="https://microservices.io/patterns/data/database-per-service.html">https://microservices.io/patterns/data/database-per-service.html</a></li>
<li>External reference: <a href="https://microservices.io/patterns/microservices.html">https://microservices.io/patterns/microservices.html</a></li>
</ul>
<ul>
<li>see,
<ul>
<li><a href="/braindump/posts/saga/">saga</a>,</li>
</ul>
</li>
</ul>
<blockquote>
<p>Tail the database transaction log and publish each message/event inserted into
the outbox to the message broker</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/transaction-log-tailing.html">https://microservices.io/patterns/data/transaction-log-tailing.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Relatively obscure although becoming increasing common</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/transaction-log-tailing.html">https://microservices.io/patterns/data/transaction-log-tailing.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Tricky to avoid duplicate publishing</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/transaction-log-tailing.html">https://microservices.io/patterns/data/transaction-log-tailing.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>How to reliably/atomically update the database and publish messages/events?</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/transactional-outbox.html">https://microservices.io/patterns/data/transactional-outbox.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>service that uses a relational database inserts messages/events into an outbox
table</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/transactional-outbox.html">https://microservices.io/patterns/data/transactional-outbox.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>service that uses a NoSQL database appends the messages/events to attribute of
the record</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/transactional-outbox.html">https://microservices.io/patterns/data/transactional-outbox.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>The service publishes high-level domain events</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/transactional-outbox.html">https://microservices.io/patterns/data/transactional-outbox.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>No <a href="/braindump/posts/two_phase_commit/">2PC</a> required</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/transactional-outbox.html">https://microservices.io/patterns/data/transactional-outbox.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>The Event sourcing is an alternative solution</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/transactional-outbox.html">https://microservices.io/patterns/data/transactional-outbox.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>From Domain-Driven Design (DDD).</p>
<p>A graph of objects that can be treated as a unit</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/aggregate.html">https://microservices.io/patterns/data/aggregate.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Organize the business logic of a service as a collection of DDD aggregates that
emit domain events when they created or updated.  The service publishes these
domain events so that they can be consumed by other services</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/domain-event.html">https://microservices.io/patterns/data/domain-event.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Event sourcing persists the state of a business entity such an Order or a
Customer as a sequence of state-changing events.  Whenever the state of a
business entity changes, a new event is appended to the list of events.  Since
saving an event is a single operation, it is inherently atomic.  The application
reconstructs an entity’s current state by replaying the events</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/event-sourcing.html">https://microservices.io/patterns/data/event-sourcing.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Applications persist events in an event store, which is a database of events.</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/event-sourcing.html">https://microservices.io/patterns/data/event-sourcing.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>The store has an API for adding and retrieving an entity’s events.  The event
store also behaves like a message broker.  It provides an API that enables
services to subscribe to events.  When a service saves an event in the event
store, it is delivered to all interested subscribers</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/event-sourcing.html">https://microservices.io/patterns/data/event-sourcing.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>order to optimize loading, an application can periodically save a snapshot of an
entity’s current state.  To reconstruct the current state, the application finds
the most recent snapshot and the events that have occurred since that snapshot.
As a result, there are fewer events to replay</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/event-sourcing.html">https://microservices.io/patterns/data/event-sourcing.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>solves one of the key problems in implementing an event-driven architecture and
makes it possible to reliably publish events whenever state changes</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/event-sourcing.html">https://microservices.io/patterns/data/event-sourcing.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Because it persists events rather than domain objects, it mostly avoids the
object‑relational impedance mismatch problem</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/event-sourcing.html">https://microservices.io/patterns/data/event-sourcing.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>100% reliable audit log of the changes made to a business entity</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/event-sourcing.html">https://microservices.io/patterns/data/event-sourcing.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>different and unfamiliar style of programming and so there is a learning curve.</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/event-sourcing.html">https://microservices.io/patterns/data/event-sourcing.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>difficult to query since it requires typical queries to reconstruct the state of
the business entities. That is likely to be complex and inefficient</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/event-sourcing.html">https://microservices.io/patterns/data/event-sourcing.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>As a result, the application must use Command Query Responsibility Segregation
(CQRS) to implement queries.  This in turn means that applications must handle
eventually consistent data</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/event-sourcing.html">https://microservices.io/patterns/data/event-sourcing.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Define a view database, which is a read-only replica that is designed to support
that query.  The application keeps the replica up to data by subscribing to
Domain events published by the service that own the data.</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/cqrs.html">https://microservices.io/patterns/data/cqrs.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Supports multiple denormalized views that are scalable and performant</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/cqrs.html">https://microservices.io/patterns/data/cqrs.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Improved separation of concerns = simpler command and query models</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/cqrs.html">https://microservices.io/patterns/data/cqrs.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Increased complexity</p>
<ul>
<li>Potential code duplication</li>
<li>Replication lag/eventually consistent views</li>
</ul>
<p>&mdash; <a href="https://microservices.io/patterns/data/cqrs.html">https://microservices.io/patterns/data/cqrs.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>When making a request to a service, the client makes a request via a router
(a.k.a load balancer) that runs at a well known location.  The router queries a
service registry, which might be built into the router, and forwards the request
to an available service instance.</p>
<p>&mdash; <a href="https://microservices.io/patterns/server-side-discovery.html">https://microservices.io/patterns/server-side-discovery.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Implement a service registry, which is a database of services, their instances
and their locations.  Service instances are registered with the service registry
on startup and deregistered on shutdown.  Client of the service and/or routers
query the service registry to find the available instances of a service.  A
service registry might invoke a service instance’s health check API to verify
that it is able to handle requests</p>
<p>&mdash; <a href="https://microservices.io/patterns/service-registry.html">https://microservices.io/patterns/service-registry.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Build your microservices using a microservice chassis framework, which handles
cross-cutting concerns</p>
<p>&mdash; <a href="https://microservices.io/patterns/microservice-chassis.html">https://microservices.io/patterns/microservice-chassis.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>The major benefit of a microservice chassis is that you can quickly and easy get
started with developing a microservice</p>
<p>&mdash; <a href="https://microservices.io/patterns/microservice-chassis.html">https://microservices.io/patterns/microservice-chassis.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>When making a request to a service, the client obtains the location of a service
instance by querying a Service Registry, which knows the locations of all
service instances</p>
<p>&mdash; <a href="https://microservices.io/patterns/client-side-discovery.html">https://microservices.io/patterns/client-side-discovery.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Keep each microservice’s persistent data private to that service and accessible
only via its API.  A service’s transactions only involve its database</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/database-per-service.html">https://microservices.io/patterns/data/database-per-service.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>service’s database is effectively part of the implementation of that service.
It cannot be accessed directly by other services</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/database-per-service.html">https://microservices.io/patterns/data/database-per-service.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Without some kind of barrier to enforce encapsulation, developers will always be
tempted to bypass a service’s API and access it’s data directly.</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/database-per-service.html">https://microservices.io/patterns/data/database-per-service.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Distributed transactions are best avoided because of the CAP theorem.  Moreover,
many modern (NoSQL) databases don’t support them.</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/database-per-service.html">https://microservices.io/patterns/data/database-per-service.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>There are various patterns/solutions for implementing transactions and queries
that span services:</p>
<p>&mdash; <a href="https://microservices.io/patterns/data/database-per-service.html">https://microservices.io/patterns/data/database-per-service.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>There are logical components corresponding to different functional areas of the
application</p>
<p>&mdash; <a href="https://microservices.io/patterns/microservices.html">https://microservices.io/patterns/microservices.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>team of developers</p>
<p>&mdash; <a href="https://microservices.io/patterns/microservices.html">https://microservices.io/patterns/microservices.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>New team members must quickly become productive</p>
<p>&mdash; <a href="https://microservices.io/patterns/microservices.html">https://microservices.io/patterns/microservices.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>each service is relatively small and so is easier to understand and change</p>
<p>&mdash; <a href="https://microservices.io/patterns/microservices.html">https://microservices.io/patterns/microservices.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>additional complexity</p>
<p>&mdash; <a href="https://microservices.io/patterns/microservices.html">https://microservices.io/patterns/microservices.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>inter-service communication mechanism and deal with partial failure</p>
<p>&mdash; <a href="https://microservices.io/patterns/microservices.html">https://microservices.io/patterns/microservices.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>Implementing requests that span multiple services is more difficult</p>
<p>&mdash; <a href="https://microservices.io/patterns/microservices.html">https://microservices.io/patterns/microservices.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>tangled dependencies might make it difficult to decompose your monolithic application into a set of services.</p>
<p>&mdash; <a href="https://microservices.io/patterns/microservices.html">https://microservices.io/patterns/microservices.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>SRP defines a responsibility of a class as a reason to change, and states that a
class should only have one reason to change.  It make sense to apply the SRP to
service design as well.</p>
<p>&mdash; <a href="https://microservices.io/patterns/microservices.html">https://microservices.io/patterns/microservices.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>loose coupling, each service has its own database.</p>
<p>&mdash; <a href="https://microservices.io/patterns/microservices.html">https://microservices.io/patterns/microservices.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>application must instead use the <a href="/braindump/posts/saga/">Saga</a> pattern</p>
<p>&mdash; <a href="https://microservices.io/patterns/microservices.html">https://microservices.io/patterns/microservices.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>service publishes an event when its data changes.  Other services consume that
event and update their data.  There are several ways of reliably updating data
and publishing events including Event Sourcing and Transaction Log Tailing</p>
<p>&mdash; <a href="https://microservices.io/patterns/microservices.html">https://microservices.io/patterns/microservices.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>The Database per Service pattern describes how each service has its own database
in order to ensure loose coupling</p>
<p>&mdash; <a href="https://microservices.io/patterns/microservices.html">https://microservices.io/patterns/microservices.html</a></p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>The API Gateway pattern defines how clients access the services in a
microservice architecture</p>
<p>&mdash; <a href="https://microservices.io/patterns/microservices.html">https://microservices.io/patterns/microservices.html</a></p>
</blockquote>
<!--more-->
<h2 id="notes-linking-here">Notes linking here</h2>
<ul>
<li><a href="/braindump/posts/ko/">ko</a></li>
<li><a href="/braindump/posts/saga/">saga</a></li>
</ul>
<h2 id="permalink"><a href="https://konubinix.eu/braindump/e455a784-8c15-4449-980b-ef4d94398baf?title=microservice">Permalink</a></h2>
      </div>
	  <aside class="date"><time>Last updated: 08 Dec 2021</time></aside>
	  <aside class="date"><time>Published&nbsp;&nbsp;&nbsp;: 25 Mar 2021</time></aside>
    </div>
  </div>
</div>

<script src="/braindump/js/URI.js" type="text/javascript"></script>

<script src="/braindump/js/page.js" type="text/javascript"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>
