<!DOCTYPE html>
<html><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="google-site-verification" content="bLmaFyyXugiCqSup-eIIIx0B4CngtdF_svyMMKQbS5E" />
<script src="https://hypothes.is/embed.js" async></script>
<title>Are There Non Blockchain Usages of Ecdsa/Secp256k1? &middot; Konubinix&#39; Site</title>

<link rel="stylesheet" href="/blog/css/main.min.8e2ccebba2bd2b151f513c5ea3c62a25d4614364fb0bc5a0261ccdc2b49f020047a52512e7e59e5d513e3aec1ed4fedb503d494c430c930053ef8f6c8a5d7d23.css" integrity="sha512-jizOu6K9KxUfUTxeo8YqJdRhQ2T7C8WgJhzNwrSfAgBHpSUS5&#43;WeXVE&#43;Ouwe1P7bUD1JTEMMkwBT749sil19Iw==" type="text/css" />


<link rel="stylesheet" href="/ipfs/QmQFVQS89fv1XUNFcjwCKDePzckuT9kpuAVNYUwNdEfYcv/css/all.css"/>
<link rel="stylesheet" href="/blog/css/links.min.66488b1bd98835c9d323aceb9cb379cbdf615c46936837066b038781a80444ba.css"/>
<script type="text/javascript"
		src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<link rel="shortcut icon" href="/ipfs/QmVFwYV7YRZLKU3ybN1hW4jqfyZGPLKJwd8toN2wHz5UAD?a.png" type="image/x-icon" />

<body class="container"><header>
	<a href="/blog//"><h5 class="site-title">Konubinix&#39; site</h5></a>
  <nav class="footer-nav">
  <ul>
	<li><a href="/blog/posts/"><i class="icon fas fa-blog"></i></a></li>
    <li><a href="/braindump/"><i class="fas fa-brain"></i></a></li>
    <li><a href="mailto:konubinixweb@gmail.com"><i class="fas fa-envelope-square"></i></a></li>
    <li><a href="https://github.com/konubinix"><i class="fab fa-github-square"></i></a></li>
    <li><a href="https://linkedin.com/in/samuel-loury-61259040"><i class="fab fa-linkedin"></i></a></li>
    <li><a href="/blog/index.xml"><i class="fas fa-rss-square"></i></a></li>
	<li><a href="/blog/tags/"><i class="fa fa-tag"></i></a></li>
    <li><a href="/blog/blog_search"><i class="icon fa fa-search"></i></a></li>
  </ul>
</nav>

</header>

<main>
  <header>
	<h1 class="underline">Are There Non Blockchain Usages of Ecdsa/Secp256k1?</h1>
	<span class="badge badge-pill badge-warning"><a href="/blog/tags/fleeting/">Fleeting</a></span></header>
  <article>
	<p>Considering that <a href="https://konubinix.eu/braindump/posts/hashicorp/?title=hashicorp#">Hashicorp</a> needs real world usages to support new
cryptosystems, and that they don&rsquo;t plan to support blockchain yet, this <a href="https://github.com/hashicorp/vault/pull/12685">pull request</a> was rejected.</p>
<p>I tried to <a href="https://konubinix.eu/braindump/posts/rationalisation/?title=rationalisation#">rationalize</a> this usage and looked for other usages of this algorithm
using this curve.</p>
<p>Note that the curve <a href="https://konubinix.eu/braindump/posts/secp256k1/?title=secp256k1#">secp256k1</a> not to be confused with the <a href="https://konubinix.eu/braindump/posts/secp256r1/?title=secp256r1#">secp256r1</a>, also known
as P-256 (NIST) or prime256v1 (ASN OID).</p>
<p>I could find out that openssl tackle <a href="https://konubinix.eu/braindump/posts/ecdsa/?title=ecdsa#">ECDSA</a>.</p>
<blockquote>
<p>The only Elliptic Curve algorithms that OpenSSL currently supports are Elliptic
Curve Diffie Hellman (ECDH) for key agreement and Elliptic Curve Digital
Signature Algorithm (ECDSA) for signing/verifying</p>
<p>&mdash; <a href="https://wiki.openssl.org/index.php/Command_Line_Elliptic_Curve_Operations">https://wiki.openssl.org/index.php/Command_Line_Elliptic_Curve_Operations</a></p>
</blockquote>
<p>And issuing the following command tells me that it supports both <a href="https://konubinix.eu/braindump/posts/secp256k1/?title=secp256k1#">secp256k1</a> and
<a href="https://konubinix.eu/braindump/posts/secp256r1/?title=secp256r1#">secp256r1</a> curves.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>openssl ecparam -list_curves|grep -e secp256 -e prime256
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>secp256k1 : SECG curve over a 256 bit prime field
</span></span><span style="display:flex;"><span>prime256v1: X9.62/SECG curve over a 256 bit prime field
</span></span></code></pre></div><p>But, looking for real world use cases of openssl with this curve gives me only
<a href="https://konubinix.eu/braindump/posts/bitcoin/?title=bitcoin#">bitcoin</a> and <a href="https://konubinix.eu/braindump/posts/ethereum/?title=ethereum#">ethereum</a> usages.</p>
<ul>
<li><a href="https://stackoverflow.com/questions/53502096/openssl-c-c-ec-secp256k1-key-generation">https://stackoverflow.com/questions/53502096/openssl-c-c-ec-secp256k1-key-generation</a></li>
<li><a href="https://bitcoin.stackexchange.com/questions/96414/openssl-magic-values-secp256k1-and-ecdsa-similarities-what-makes-secp256k1-spe">https://bitcoin.stackexchange.com/questions/96414/openssl-magic-values-secp256k1-and-ecdsa-similarities-what-makes-secp256k1-spe</a></li>
<li><a href="https://github.com/openssl/openssl/issues/15675">https://github.com/openssl/openssl/issues/15675</a></li>
<li><a href="https://medium.com/@skloesch/openssl-and-ecdsa-signatures-db60c005b1f4">https://medium.com/@skloesch/openssl-and-ecdsa-signatures-db60c005b1f4</a></li>
</ul>
<p>There is one usage that appears to use secp256k1, but it sounds like they
confuse it with P-256.</p>
<blockquote>
<p>Generate ECDSA keys with the P-256 (secp256k1) curve</p>
<p>&mdash; <a href="https://learn.akamai.com/en-us/webhelp/iot/jwt-access-control/GUID-C3B1D111-E0B5-4B3B-9FF0-06D48CF40679.html">https://learn.akamai.com/en-us/webhelp/iot/jwt-access-control/GUID-C3B1D111-E0B5-4B3B-9FF0-06D48CF40679.html</a></p>
</blockquote>
<p>There is also another tutorial using secp256k1, but without telling whether they
use it or not in real life. They don&rsquo;t even advise to use it.</p>
<blockquote>
<p>Use the following command to generate an EC parameters file of curve secp256k1:</p>
<p>$ openssl ecparam -name secp256k1 -out secp256k1.pem</p>
<p>Replace secp256k1 with any other name obtained from the openssl ecparam -list_curves command.</p>
<p>&mdash; <a href="https://docs.rackspace.com/support/how-to/elliptic-curve-operations/">https://docs.rackspace.com/support/how-to/elliptic-curve-operations/</a></p>
</blockquote>
<p>Actually, they most likely copied, pasted and rephrased the openssl wiki.</p>
<blockquote>
<p>An EC parameters file can then be generated for any of the built-in named curves as follows:</p>
<p>$ openssl ecparam -name secp256k1 -out secp256k1.pem</p>
<p>Replace secp256k1 in the above with whichever curve you are interested in.</p>
<p>&mdash; <a href="https://wiki.openssl.org/index.php/Command_Line_Elliptic_Curve_Operations">https://wiki.openssl.org/index.php/Command_Line_Elliptic_Curve_Operations</a></p>
</blockquote>
<p>So I guess it does not count either.</p>
<p>Then, trying to be more aggressive, with this request &ldquo;openssl secp256k1
-bitcoin -ethereum -btc -eth&rdquo;.</p>
<p>I still find people confusing it with P-256.</p>
<blockquote>
<p>If you have concerns about writing the unencrypted private key to disk, you can do both the generation and encryption of the key in one step like so:</p>
<p>$ openssl ecparam -genkey -name secp256k1 | openssl ec -aes256 -out privatekey.pem</p>
<p>This generates a P-256 key, then prompts you for a passphrase. The key is then encrypted using AES256 and saved into privatekey.pem.</p>
<p>&mdash; <a href="https://newbedev.com/openssl-ecdsa-private-key-passphrase">https://newbedev.com/openssl-ecdsa-private-key-passphrase</a></p>
</blockquote>
<p>And the others results are about playing with secp256k1, without indicating why
(most likely to play with blockchain but without mentioning it).</p>
<p>By trying a bit further, I found out that there was a hype in 2014 about a
&ldquo;better internet&rdquo; using <a href="https://konubinix.eu/braindump/posts/cryptographie_a_courbe_elliptique/?title=cryptographie_a_courbe_elliptique#">ECC</a>.</p>
<p>So I basically tried to find out what are the algorithms and curves used in the
certificates installed in my machine.</p>
<p>First, let&rsquo;s expose the information out of one certificate.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>extract_curve <span style="color:#000;font-weight:bold">(</span> <span style="color:#000;font-weight:bold">)</span>  <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    openssl x509 -in <span style="color:#d14">&#34;</span><span style="color:#008080">$1</span><span style="color:#d14">&#34;</span> -text|gi -B <span style="color:#099">1</span> <span style="color:#d14">&#34;nist cur&#34;</span>|<span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">while</span> <span style="color:#0086b3">read</span> line
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">do</span>
</span></span><span style="display:flex;"><span>            <span style="color:#0086b3">echo</span> -n <span style="color:#d14">&#34;</span><span style="color:#008080">$line</span><span style="color:#d14"> &#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">done</span>
</span></span><span style="display:flex;"><span>        <span style="color:#0086b3">echo</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>Then, I run this other all the certificates installed on my machine.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>find /etc/ssl/certs/ -type l |<span style="color:#000;font-weight:bold">while</span> <span style="color:#0086b3">read</span> cert
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">do</span>
</span></span><span style="display:flex;"><span>    extract_curve <span style="color:#d14">&#34;</span><span style="color:#d14">${</span><span style="color:#008080">cert</span><span style="color:#d14">}</span><span style="color:#d14">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">done</span> | sort | uniq -c
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>12 ASN1 OID: prime256v1 NIST CURVE: P-256
</span></span><span style="display:flex;"><span>57 ASN1 OID: secp384r1 NIST CURVE: P-384
</span></span></code></pre></div><p>Still no luck, secp256k1 is not used, while secp256r1, is used by 12
certificates authorities and secp384r1 appears even more popular.</p>
<p>Finally, I can find out other people stating that secp256k1 is actually used
only in the blockchain world. Even more narrow in the <a href="https://konubinix.eu/braindump/posts/cryptomonnaie/?title=cryptomonnaie#">cryptocurrency</a>
community.</p>
<blockquote>
<p>secp256k1 is used almost exclusively in the cryptocurrency community. Outside of
that community, secp256k1 is a highly unusual curve to use. This means that it
has a fairly narrow set of use-cases in which it is a reasonable default. This
adds asymmetrical API risk to the API: users building cryptocurrency wallets
will immediately know that they need secp256k1 and can dismiss the other
choices, while users building other constructions (of whom there are vastly
more) will now need to research and consider secp256k1 to validate whether it is
suitable before they dismiss it. The burden of this new API falls much more
heavily on the more-common use-cases. For better or worse, P-256 has much wider
deployment than secp256k1, and therefore has an easier time justifying its
presence in Swift Crypto than secp256k1 does.</p>
<p>&mdash; <a href="https://github.com/apple/swift-crypto/issues/8">https://github.com/apple/swift-crypto/issues/8</a></p>
</blockquote>
<p>Then, I <a href="https://konubinix.eu/braindump/posts/decide_de_croire/?title=decide_de_croire#">decided to believe</a> that secp256k1 is not used in contexts other
than blockchain and understand (and agree with) the decision of <a href="https://konubinix.eu/braindump/posts/hashicorp/?title=hashicorp#">Hashicorp</a>
of refusing this pull request.</p>
<h2 id="permalink"><a href="https://konubinix.eu/blog/7751544b-4c6d-419c-8637-3ca03f83cba2?title=are_there_non_blockchain_usages_of_ecdsa_secp256k1">Permalink</a></h2>
  </article>
  <aside class="date"><time>Last updated: 01 Sep 2022</time></aside>
  <aside class="date"><time>Published&nbsp;&nbsp;&nbsp;: 10 Nov 2021</time></aside>
</main>
<hr/>
<footer>
  <nav class="footer-nav">
  <ul>
	<li><a href="/blog/posts/"><i class="icon fas fa-blog"></i></a></li>
    <li><a href="/braindump/"><i class="fas fa-brain"></i></a></li>
    <li><a href="mailto:konubinixweb@gmail.com"><i class="fas fa-envelope-square"></i></a></li>
    <li><a href="https://github.com/konubinix"><i class="fab fa-github-square"></i></a></li>
    <li><a href="https://linkedin.com/in/samuel-loury-61259040"><i class="fab fa-linkedin"></i></a></li>
    <li><a href="/blog/index.xml"><i class="fas fa-rss-square"></i></a></li>
	<li><a href="/blog/tags/"><i class="fa fa-tag"></i></a></li>
    <li><a href="/blog/blog_search"><i class="icon fa fa-search"></i></a></li>
  </ul>
</nav>

  <p>&copy; 2025 Samuel Loury</p>
</footer>
</body>
</html>
